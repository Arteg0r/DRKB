#spec #event 

## Введение

События Отношений определяют уровень отношений между каждой парой Героев в Отряде игрока. События Отношений возникают при передвижении Отряда Героев по Карте Мира. Источник отношений - приверженность Героя одной из двух сторон-антагонистов, которая определяется через соотношение основных характеристик внутри Героя. Отношения могут развиваться в положительную и отрицательную сторону и при достижению критических рубежей (симпания, неприязнь...) оказывают влияние на События Боя (будут описаны в отдельном ТЗ).

![alignment.jpg](https://github.com/Arteg0r/DRKB/blob/main/alignment.jpg)


## Глоссарий ТЗ

*Группа основных характеристик Героя* - 8 характеристик, которые есть у каждого Героя. Их значения задаются вручную для каждого Героя в виде целых положительных чисел. В дальнейшем ожидается, что эти характеристики станут определять все вторичные хар-ки и признаки Героев.

*Группа характеристик Духа* - 4 характеристики, находящиеся на Диаграмме Героя в половине Духа. Сюда относятся следущие хар-ки: Аскетизм asc; Духовность spi; Умствование int; Ментальное влияние cha

*Группа характеристик Тела* - 4 характеристики, находящиеся на Диаграмме Героя в половине Тела. Следущие хар-ки: Физический соблазн tem; Телесность con; Решительность str; Физическая хитрость dex

*Герой Духа* - Герой, у коротого сумма хар-к Духа превышает сумму хар-к Тела на 5 и более баллов. 

*Герой Тела* - Герой, у коротого сумма хар-к Тела превышает сумму хар-к Духа на 5 и более баллов.

*Нейтральный Герой* - Герой, у коротого разница в суммах хар-к Тела и хар-к Духа не превышает 5 баллов.

*Сила приверженности Духу* - числовое значение перекоса в сторону Духа у Героя (в баллах). 

*Сила одержимости Телом* - числовое значение перекоса в сторону Тела у Героя (в баллах)

*Баллы Отношений* - основной результат События Отношений 

*Шкала Отношений* - графическое отображение баллов Отношений между парой Героев на шкале от -30 до 30. Есть 4 рубежа - два положительных и два отрицательных.


## Компоненты Событий

- Правила взаимодействия с другими событиями и объектами Карты Мира
- Конфигурационный лист в основной [таблице](https://docs.google.com/spreadsheets/d/12acMQ8UTlDRHP0NvzSGVLYKb9QMhw2AjD9EKXTQug3U/edit#gid=2067628352)
- Алгоритм инициации и протекания События
- Интерфейс GUI для События
- Опционально и надо обсуждать, не описан в этом ТЗ: GUI просмотра текущих отношений Героев в отряде


## Взаимодействия с Событиями Гексов, POI  и Отрядами Врагов

События Отношений полностью независимы от Событий Гексов. Отряд может получить на одном Гексе события обеих типов, но не более одного для каждого типа.

Как и События Гексов События Отношений не могу происходить на Гексах с POI или Отрядами Врагов.


## Алгоритм возникновения и протекания Событий Отношений

1) Проверить для каждого Героя, к какому типу он относится - Духа, Тела или Нейтральному, а также определить силу его перекос в сторону Духа или Тела.
2) Высчитать шансы инициировать Отношения для каждого Героя
3) Построить очередь Героев для проверки возможности возникновения отношений - от Героев с меньшим перекосом к Героям с большим
4) Опросить Героев по очереди, в соответствии с личными шансами, чтобы понять, кто готов инициировать отношения
5) Если один из Героев готов к Отношениям, выбрать целевую группу (Духи, Нейтралы...)  по таблице, с учетом степени перекоса Героя
6) Выбрать цель внутри группы согласно таблице
7) Учесть кол-во баллов Отношений в зависимости от того, между парой Героев какого типа они произшли
8) Если нужно применить бонусы, определить случайным образом характеристики затронутого Героя, учесть изменения
9) Отобразить результат События Отношений в окошке События


## Интерфейсы События

Событие Отношения оформлено в виде всплывающего поверх Карты Мира окна. Окно блокирует перемещение игрока на карте мира до тех пор, пока остается активным, и не будет закрыто. Окно состоит из следующих частей:

1) Портрет Герой 1, Имя Герой 1 (Дух/Тело LVL) (инициатор события)
2) Портрет Герой 2, Имя Герой 2 (Дух/Тело LVL) (получатель события)
3) Шкала отношений с текущей точкой и сдвигом по шкале, случившимся в ходе события (сдвиг можно оформить в виде закрашенного участка другого цвет либо числом, например, +5). Также указан текущий рубеж отношений.
   
   Предложение по размещению 1-3: слева 1, справа 2, между ними (чуть ниже?) 3 

4) Если произошли измнения в характеристиках одного из Героев, это нужно тоже отразить: Имя Героя (Дух/Тело LVL): Название Характеристики (старое значение) -> Название Характеристики (старое значение) 
   Если затронуто несколько характеристик - столбиком одну под другой
   
5) Если достигнут новый рубеж, то сообщаем (если нет - ничего не сообщаем):

- Между Имя 1 и Имя 2 возникла симпания!

- Имя 1 и Имя 2 подружились!

- Имя 1 и Имя 2 чувствуют взаимную неприязнь!

- Имя 1 и Имя 2 теперь не переносят друг друга!
  
  Если происходит уход с рубежа, вешаем другие объявления:
  
- Имя 1 и Имя 2 теперь сохраняют нейтралитет (когда ушли в сторону 0 с рубежа 15 или -15)
- Вражда между Имя 1 и Имя 2 закончилась!
- Дружба между Имя 1 и Имя 2 подошла к концу!




