#spec #tavern

## Введение

Переработка существующей системы Библиотека для создания прогрессии внутри игры. В режиме Таверны часть контента игры при запуске приложения заблокирована. Внутри Таверны указаны возможности по разблокировке при соблюдении соотвествующих условий.

**Важно!** Для нужд разработки и плейтеста нужно оставить возможность включать чит-разлочку контента в игре в обход игровых условий. Можно выполнить в виде переключателя внутри меню Настроек. Если он активирован, пользователь может немедленно разлочить любой элемент игры без соблюдения игровых условий его разлочки. При этом, чит-переключатель можно в любой момент отключить, и на неразблокированные ранее элементы вновь накладываются ограничения.


## Компоненты

**Новые источники данных:**

- Список ресурсов, связь ресурсов с противниками, шансы выдачи, [ссылка](https://docs.google.com/spreadsheets/d/12acMQ8UTlDRHP0NvzSGVLYKb9QMhw2AjD9EKXTQug3U/edit#gid=961128796) [progress]([url](https://github.com/users/cptn-solo/projects/7/views/1?pane=issue&itemId=42995755)) 
- Новый тип Гекса (Лес и Болото) и его атрибуты, [ссылка](https://docs.google.com/spreadsheets/d/12acMQ8UTlDRHP0NvzSGVLYKb9QMhw2AjD9EKXTQug3U/edit#gid=467871721)
- Новые События Гексов, обновление структуры Событий Гексов - третий вариант награды, [ссылка](https://docs.google.com/spreadsheets/d/12acMQ8UTlDRHP0NvzSGVLYKb9QMhw2AjD9EKXTQug3U/edit#gid=2050044954) 
- Обновленный словарь Событий Гексов, [ссылка](https://docs.google.com/spreadsheets/d/12acMQ8UTlDRHP0NvzSGVLYKb9QMhw2AjD9EKXTQug3U/edit#gid=1310431768)
- Список счетчиков игровых событий, [ссылка](https://docs.google.com/spreadsheets/d/12acMQ8UTlDRHP0NvzSGVLYKb9QMhw2AjD9EKXTQug3U/edit#gid=1627160388)
- Закрепление элементов игры по Героям, установка условий их разлочки, [ссылка](https://docs.google.com/spreadsheets/d/12acMQ8UTlDRHP0NvzSGVLYKb9QMhw2AjD9EKXTQug3U/edit#gid=435823011)

**Новые интерфейсы:**

- Обновление gui для Событий Гексов - горизонтальные кнопки
- Новый интерфейс: экран Героя. Нужен для изучения (в Рейде, в Библиотеке), разблокировки и совершенствования Героя (в Библиотеке). Обсудили с Костей, что можно организовать через отдельную сцену (с другой стороны, он же высказал предложение сделать данный экран "экономно")
- Обновление экрана Библиотеки - вне дебаг режима скрыть Героев с флагом "E"
- Новый пункт меню в Настройках
- Панель Ресурсов - отображает деньги в сложенном состоянии, в разложенном - весь список ресурсов. Отображается в Рейде и Таверне.
- Модальное окошко получение ресурсов (после боя)


##  Новые правила

- Контент, не заблокированный явным образом, считается разблокированным и доступным для игры с первого запуска.
- Шаблоны События Гекса используются вне зависимости от Силы Черты Героя, с равной вероятностью.
- Нужно различать хорошее и плохое событие (отмечено красным) при генерации описания события по шаблону, потому что для каждого типа [свой набор слов](https://docs.google.com/spreadsheets/d/12acMQ8UTlDRHP0NvzSGVLYKb9QMhw2AjD9EKXTQug3U/edit#gid=1310431768).
- Расчет награды за бой золотом происходит как раньше, а расчет выдаваемых ресурсов регулируется новой [таблицей](https://docs.google.com/spreadsheets/d/12acMQ8UTlDRHP0NvzSGVLYKb9QMhw2AjD9EKXTQug3U/edit#gid=961128796)
- Существа с флагом "E" в стандартном режиме Таверны не отображаются (но доступны в дебаг-режиме) 


## Способности Героев

Прокачка Героев в Таверне не только разблокирует контент игры, но и добавляет им способности, которые могут влиять как на весь отряд, так и на отдельного Героя. В рамках данного ТЗ предусмотрены следующие способности Героев:

- Герой увеличивает запас очков здоровья всем Героям в Отряде (включая себя). Увеличение происходит в момент выхода отряда с данным Героем в Рейд. Увеличение не является увеличением максимального кол-ва здоровья Героя - его можно рассматривать как однократное увеличение единиц здоровья, то есть при восстановлении Здоровья любым способом данные очки не восстанавливаются. При смерти Героя дополнительное здоровье не пропадает.
- Герой увеличивает уровень всех имеющихся черт у всех Героев в отряде (включая себя). Увеличение происходит в момент выхода отряда с данным Героем в Рейд. При смерти Героя дополнительные уровни черт не пропадают.
- Герой увеличивает стартовый запас Стамины Отряда. Увеличение происходит при первичном расчете Стамины - к базовому показателю добавляется соотвествующий процент. При этом макс запас Стамины не увеличивается (при последующем восстановлении Стамины). При смерти Героя дополнительная Стамина не пропадает.
- Герой увеличивает стартовое кол-во очков Отношений между всеми парами Героев в Отряде. Увеличение происходит в момент выхода отряда с данным Героем в Рейд. При смерти Героя дополнительные очки отношений не пропадают.
- Герой удваивает личный урон по выбранным существам. Против таких существ в два раза увеличиваются показатели минимального и максимального урона Героя. Эта способность индивидуальна, и не передается другим членам Отряда.

Способности Героя применяются только в том случае, если он является активным участником Отряда (а не сидит в Таверне).


## Разблокировка контента

В отличие от Способностей Героев, разблокированный контент остается в Рейде вне зависимости от того, участвует ли в данном Рейде Герой, разблокировавший контент.
